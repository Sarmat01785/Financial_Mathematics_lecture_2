# Финансовая математика
## Урок 2. Проведение процентных расчетов

### Денежный поток: Определение

**Денежный поток** — это движение денежных средств внутрь и наружу компании, проекта или финансового продукта. Он отражает способность субъекта генерировать достаточное количество наличности для поддержания операционной деятельности, инвестиционных проектов и финансовых обязательств.

#### Классификация денежных потоков

Денежные потоки делятся на несколько типов:

- **Операционные денежные потоки:** 
  - Поступления от продаж товаров и услуг.
  - Выплаты поставщикам и сотрудникам.
  - Денежные налоги и проценты.

- **Инвестиционные денежные потоки:** 
  - Покупка или продажа активов (например, оборудования, недвижимости).
  - Инвестиции в ценные бумаги, погашение займов.

- **Финансовые денежные потоки:** 
  - Выпуск и погашение акций, облигаций.
  - Получение и возврат кредитов.
  - Выплата дивидендов и процентов.

#### Значение денежного потока

Анализ денежных потоков помогает оценить:

- Эффективность управления компанией.
- Способность к самофинансированию и развитию.
- Финансовую стабильность и платежеспособность.

Точное понимание и управление денежными потоками критически важно для успешной экономической деятельности и долгосрочного планирования.

# Концепция денежных потоков

Концепция денежных потоков — это анализ движения денежных средств, входящих и выходящих из бизнеса или проекта. Она исследует, как деньги перемещаются в компании, и является ключевым показателем ее финансовой стабильности и операционной эффективности.

Основные элементы концепции включают:

- **Поступления (Cash Inflows):** Денежные средства, получаемые от деятельности компании.
- **Выплаты (Cash Outflows):** Расходы, необходимые для поддержания операционной деятельности.
- **Чистый денежный поток (Net Cash Flow):** Разница между поступлениями и выплатами за определенный период.
- **Временные рамки:** Анализ денежных потоков может проводиться на регулярной основе в зависимости от нужд бизнеса.
- **Прогнозирование:** Оценка будущих денежных потоков для планирования и инвестиционных решений.
- **Дисконтирование:** Метод оценки текущей стоимости будущих денежных потоков, учитывающий риск и временную стоимость денег.

# Типичная структура денежного потока инвестиционного проекта

Инвестиционные проекты характеризуются денежными потоками, которые включают следующие основные элементы:

1. **Начальные инвестиции:**
   - Первоначальные капитальные вложения в проект.
   - Покупка оборудования, недвижимости и других активов.

2. **Операционные денежные потоки:**
   - Ежегодные доходы и расходы в процессе эксплуатации проекта.
   - Включают в себя все операционные поступления и платежи.

3. **Окончательный денежный поток:**
   - Денежный поток при завершении или продаже проекта.
   - Может включать доход от ликвидации активов.

4. **Налоги и льготы:**
   - Уплата налогов, которая уменьшает денежные потоки.
   - Возможные налоговые льготы или субсидии, увеличивающие денежные потоки.

5. **Чистый денежный поток:**
   - Разница между поступлениями и выплатами за каждый период.
   - Отражает реальную финансовую прибыльность проекта.

В анализе денежных потоков используется дисконтирование для приведения будущих денежных потоков к их текущей стоимости и оценки общей ценности инвестиционного проекта.

# Аннуитеты: Определение

Аннуитеты — это финансовые продукты, представляющие собой серию равномерных платежей, производимых через фиксированные интервалы времени. Они являются одним из основных финансовых инструментов, используемых для планирования на пенсию, кредитования и страхования.

## Основные типы аннуитетов

### Обычные аннуитеты (Ordinary Annuity)
Платежи по обычному аннуитету производятся в конце каждого платежного периода. Это наиболее распространенный тип аннуитета, используемый в финансовых расчетах.

Примеры:
- Ежемесячные платежи по ипотечному кредиту.
- Ежеквартальные платежи по автокредиту.

### Аннуитеты дюдуа (Annuity Due)
Платежи по аннуитету дюдуа производятся в начале каждого платежного периода.

Примеры:
- Арендная плата за квартиру, уплачиваемая в начале месяца.
- Страховые премии, уплачиваемые в начале каждого года.

## Расчеты аннуитетов

### Настоящая стоимость аннуитета (PV)
Настоящая стоимость аннуитета показывает, какова сумма единовременного платежа равна всем будущим аннуитетным платежам сейчас, учитывая определенную процентную ставку.

### Будущая стоимость аннуитета (FV)
Будущая стоимость аннуитета показывает, какова будет стоимость всех аннуитетных платежей в будущем, учитывая процентную ставку за каждый период.

Формулы для расчета аннуитетов включают переменные процентной ставки, количества платежей и суммы каждого платежа. Эти расчеты позволяют инвесторам и заемщикам планировать свои финансы и принимать обоснованные решения об инвестициях и кредитах.

### Аннуитет постнумерандо (Ordinary Annuity)
Аннуитет постнумерандо, или обычный аннуитет, это когда платежи производятся в конце каждого периода. Это наиболее часто встречающийся тип аннуитета.

Например, если вы берете ипотечный кредит или автокредит, ваш ежемесячный платеж будет считаться аннуитетом постнумерандо, поскольку вы обычно оплачиваете кредит в конце каждого месяца

### Аннуитет пренумерандо (Annuity Due)
Аннуитет пренумерандо — это когда платежи производятся в начале каждого периода. Это означает, что каждый платеж выполняется сразу, как только начинается новый период.

Примером аннуитета пренумерандо может служить арендная плата, которую обычно оплачивают в начале месяца, то есть до того, как вы фактически проживете этот месяц в квартире.

### Ключевое отличие
Ключевое отличие между двумя типами аннуитетов заключается в том, когда производятся платежи. Это отличие оказывает влияние на настоящую и будущую стоимость аннуитета, поскольку деньги имеют временную стоимость. Платежи, сделанные раньше, как в случае с аннуитетом пренумерандо, имеют большую стоимость, потому что у вас есть возможность инвестировать или использовать эти деньги в течение всего периода.

### Пример
Допустим, вы решили вложить $1,000 каждый год в пенсионный фонд. Если вы вносите эту сумму в конце года, это будет обычный аннуитет. Если вы вносите эту сумму в начале года, это будет аннуитет пренумерандо.

### Финансовые расчеты
В финансовых расчетах используются разные формулы для определения настоящей и будущей стоимости аннуитетов постнумерандо и пренумерандо. Расчеты для аннуитета пренумерандо будут показывать большую стоимость по сравнению с расчетами для обычного аннуитета, если рассматривать одинаковые суммы и процентные ставки, так как деньги доступны для использования или инвестирования на более длительный срок.

Используя эти концепции, можно более эффективно планировать личные финансы, операции с недвижимостью, инвестиции и пенсионное накопление.

# Основные формулы для расчета аннуитета

Аннуитетные платежи можно рассчитать с помощью двух ключевых формул: для текущей стоимости аннуитета постнумерандо и для будущей стоимости.

## Текущая стоимость аннуитета постнумерандо (PV)

Текущая стоимость рассчитывается по формуле:

$$
PV = A \times \frac{1 - (1 + r)^{-n}}{r}
$$

где:

- $A$ — регулярный аннуитетный платеж
- $r$ — ставка дисконтирования за один период
- $n$ — общее количество периодов (платежей)

Формула показывает, какую сумму нужно инвестировать сегодня, чтобы получить ряд равных будущих платежей.

## Будущая стоимость аннуитета постнумерандо (FV)

Будущая стоимость аннуитета постнумерандо определяется по формуле:

$$
FV = A \times \frac{(1 + r)^{n} - 1}{r}
$$

где:

- $A$ — регулярный аннуитетный платеж
- $r$ — ставка дисконтирования за один период
- $n$ — общее количество периодов (платежей)

Эта формула позволяет вычислить, какая сумма будет накоплена к концу инвестиционного периода, если вносить равномерные платежи в конце каждого периода.

# Расчет аннуитета пренумерандо

Аннуитет пренумерандо отличается от аннуитета постнумерандо тем, что платежи происходят в начале каждого периода. Это означает, что каждый платеж может приносить доход на один период дольше, чем платежи обычного аннуитета.

## Формулы для аннуитета пренумерандо

### Текущая стоимость аннуитета пренумерандо (PV due):

Текущая стоимость аннуитета пренумерандо учитывает, что первый платеж происходит немедленно:

$$
PV_{\text{due}} = A \times \left(\frac{1 - (1 + r)^{-n}}{r}\right) \times (1 + r)
$$

где:

- $A$ — регулярный аннуитетный платеж
- $r$ — ставка дисконтирования за один период
- $n$ — общее количество периодов (платежей)

### Будущая стоимость аннуитета пренумерандо (FV due):

Будущая стоимость учитывает, что каждый платеж инвестируется на один дополнительный период:

$$
FV_{\text{due}} = A \times \left(\frac{(1 + r)^{n} - 1}{r}\right) \times (1 + r)
$$

где:

- $A$ — регулярный аннуитетный платеж
- $r$ — ставка дисконтирования за один период
- $n$ — общее количество периодов (платежей)

Эти формулы позволяют точно рассчитать текущую и будущую стоимость серии платежей аннуитета пренумерандо, что важно для финансового планирования и оценки инвестиционных проектов.

# Формула текущей стоимости перпетуитета

**Перпетуитет** или **бесконечный аннуитет** — это тип аннуитета, при котором платежи продолжаются бесконечно. В таком случае формула для расчета текущей стоимости этих платежей упрощается:

$$
PV = \frac{A}{r}
$$

где:

- $A$ — Регулярный аннуитетный платеж, который выплачивается в каждом периоде навечно.
- $r$ — Ставка дисконтирования за один период.

Эта формула показывает, что текущая стоимость бесконечной серии регулярных платежей определяется просто как платеж, деленный на процентную ставку. Несмотря на то что число платежей бесконечно, текущая стоимость конечна, потому что более поздние платежи имеют все меньшую и меньшую стоимость из-за дисконтирования.

Эту формулу можно использовать для расчета стоимости таких финансовых инструментов, как вечные облигации или некоторые типы акций с фиксированными дивидендами.

### Задача. 
Если класть в банк по $1000 в течение 4 лет, начиная с текущего момента, и банк при этом начисляет
6% годовых, то какая сумма получится на конец 6-го года?


```python
# Параметры задачи
annual_deposit = 1000  # Ежегодный депозит
interest_rate = 0.06   # Годовая процентная ставка
total_years = 6        # Общее количество лет
deposits_years = 4     # Количество лет с депозитами

# Начальная сумма
total_amount = 0

# Расчет суммы на конец 6-го года
for year in range(1, total_years + 1):
    if year <= deposits_years:
        total_amount += annual_deposit
    total_amount *= (1 + interest_rate)

# Вывод результата
print(f"Сумма на конец 6-го года: ${total_amount:.2f}")
```

    Сумма на конец 6-го года: $5210.24
    

### Задача. 
Найти текущую стоимость четырёх платежей по $100, если первый платёж будет получен через
3 года, а стоимость денег равна 9%.


```python
# Параметры задачи
payment = 100       # Сумма каждого платежа
rate = 0.09         # Стоимость денег (ставка дисконтирования)
first_payment_year = 3  # Количество лет до первого платежа
number_of_payments = 4  # Количество платежей

# Расчет текущей стоимости всех платежей
current_value = sum(payment / ((1 + rate) ** (first_payment_year + i)) for i in range(number_of_payments))

# Вывод результата
print(f"Текущая стоимость четырёх платежей: ${current_value:.2f}")
```

    Текущая стоимость четырёх платежей: $272.68
    

### Задача 1. 
Человек заключил договор ренты на 20 лет, с ежемесячным платежом 30 тыс.руб. Первый платеж ожидается через месяц. Если стоимость денег равна 10% годовых, то сколько стоит такой договор? Сколько нужно заплатить в момент его заключения?


```python
# Параметры договора ренты
monthly_payment = 30000  # Ежемесячный платеж в рублях
annual_interest_rate = 0.10  # Годовая ставка дисконтирования
years = 20  # Срок договора в годах

# Переводим годовую ставку в месячную
monthly_interest_rate = annual_interest_rate / 12

# Общее количество ежемесячных платежей
total_payments = years * 12

# Расчет текущей стоимости аннуитета пренумерандо
present_value = monthly_payment * ((1 - (1 + monthly_interest_rate) ** -total_payments) / monthly_interest_rate) * (1 + monthly_interest_rate)

# Вывод результата
print(f"Текущая стоимость договора ренты: {present_value:.2f} руб.")
```

    Текущая стоимость договора ренты: 3134644.72 руб.
    

### Задача 2. 
Если рента в предыдущем примере будет бесконечной, то сколько нужно заплатить в момент заключения договора?


```python
# Параметры договора ренты
monthly_payment = 30000  # Ежемесячный платеж в рублях
annual_interest_rate = 0.10  # Годовая ставка дисконтирования

# Переводим годовую ставку в месячную
monthly_interest_rate = annual_interest_rate / 12

# Расчет текущей стоимости перпетуитета
present_value_perpetuity = monthly_payment / monthly_interest_rate

# Вывод результата
print(f"Текущая стоимость бесконечной ренты: {present_value_perpetuity:.2f} руб.")
```

    Текущая стоимость бесконечной ренты: 3600000.00 руб.
    

### Задача 3. 
Вы инвестировали 1 000 000 рублей на следующих условиях: в течение 10 лет вам будут возвращать вашу инвестицию из расчета доходности 12% годовых. Какой размер платежа будет у этого аннуитета?


```python
# Параметры инвестиции
PV = 1000000  # Текущая стоимость инвестиций в рублях
annual_interest_rate = 0.12  # Годовая процентная ставка
years = 10  # Количество лет

# Расчет размера аннуитетного платежа
A = PV * (annual_interest_rate * (1 + annual_interest_rate) ** years) / ((1 + annual_interest_rate) ** years - 1)

# Вывод результата
print(f"Размер ежегодного аннуитетного платежа: {A:.2f} руб.")
```

    Размер ежегодного аннуитетного платежа: 176984.16 руб.
    

# Облигации: Определение

Облигация — это тип долговой ценной бумаги, которую выпускают корпорации, муниципалитеты или правительства с целью привлечения капитала. Покупая облигацию, инвестор фактически занимает деньги эмитенту, который обязуется выплатить инвестору номинальную стоимость облигации по истечении установленного срока, а также производить регулярные купонные платежи.

## Ключевые характеристики облигаций

- **Номинальная стоимость**: Сумма, которую эмитент обязуется выплатить инвестору в конце срока действия облигации.
- **Купонная ставка**: Процент от номинальной стоимости облигации, который эмитент выплачивает инвестору в виде регулярных купонных платежей (обычно ежегодно или полугодово).
- **Срок погашения**: Дата, когда эмитент должен вернуть инвестору номинальную стоимость облигации.
- **Цена облигации**: Может отличаться от номинальной стоимости и меняться в зависимости от рыночных условий, таких как текущие процентные ставки и кредитный рейтинг эмитента.

## Риски и преимущества

Хотя облигации считаются более безопасными инвестициями по сравнению с акциями из-за гарантированных купонных платежей и возврата номинала, они также подвержены ряду рисков:

- **Риск дефолта**: Риск того, что эмитент не сможет выполнить свои обязательства по выплате купонов или возврату номинала.
- **Рыночные риски**: Включая изменение процентных ставок, которое может повлиять на рыночную стоимость облигации.
- **Инфляционный риск**: Риск снижения покупательной способности денежных потоков от облигации из-за инфляции.

# Цена облигации

Цена облигации определяется на основе текущей стоимости будущих денежных потоков, которые она гарантирует. Для расчета цены облигации используется процесс дисконтирования этих потоков по ставке дисконтирования. Эта ставка отражает альтернативные издержки капитала и связанный с инвестицией риск.

## Формула цены облигации

Цена облигации (PV) рассчитывается по формуле:

$$
PV = \sum_{t=1}^{T} \frac{C}{(1 + r)^t} + \frac{F}{(1 + r)^T}
$$

где:
- C — Купонный платеж, выплачиваемый каждый период.
- F — Номинальная стоимость облигации, возвращаемая инвестору в конце срока.
- r — Ставка дисконтирования или доходность до погашения.
- T — Общее количество периодов до погашения.
- t — Текущий период.

### Задача 4. 
Есть 5-ти летняя облигация, номиналом €1000 и с купоном 7%, уплачиваемым 1 раз в год. Пусть стоимость денег для держателя облигации равна 8% годовых. Какова справедливая цена облигации?

# Расчет справедливой цены облигации. Решение Задача 4.

Для определения справедливой цены облигации необходимо рассчитать текущую стоимость всех будущих купонных платежей и номинальной стоимости облигации. Расчет производится путем дисконтирования этих платежей по ставке дисконтирования, которая равна стоимости денег для держателя облигации.

## Параметры облигации

- Номинал облигации: €1000
- Купонная ставка: 7% (уплачиваемая один раз в год)
- Стоимость денег для держателя облигации: 8% годовых
- Срок облигации: 5 лет

## Формула для расчета текущей стоимости (PV)

$$
PV = \sum_{t=1}^{T} \frac{C}{(1 + r)^t} + \frac{F}{(1 + r)^T}
$$

где:
- \( C \) — годовой купонный платеж
- \( F \) — номинальная стоимость облигации
- \( r \) — ставка дисконтирования (соответствует стоимости денег для держателя облигации)
- \( n \) — количество лет до погашения облигации

## Расчет в Python


```python
def calculate_fair_price(nominal_value, coupon_rate, discount_rate, years):
    """
    Рассчитывает справедливую цену облигации.
    
    :param nominal_value: Номинальная стоимость облигации
    :param coupon_rate: Годовая купонная ставка
    :param discount_rate: Годовая стоимость денег для держателя облигации
    :param years: Срок облигации в годах
    :return: Справедливая цена облигации
    """
    # Расчет купонного платежа
    coupon_payment = nominal_value  *  coupon_rate
    
    # Расчет текущей стоимости купонных платежей
    coupon_payments_pv = sum((coupon_payment / (1 + discount_rate)  **  t) for t in range(1, years + 1))
    
    # Расчет текущей стоимости номинальной стоимости облигации
    nominal_value_pv = nominal_value / (1 + discount_rate)  **  years
    
    # Расчет справедливой цены облигации
    fair_price = coupon_payments_pv + nominal_value_pv
    
    return fair_price

# Исходные данные
nominal_value = 1000  # Номинальная стоимость облигации
coupon_rate = 0.07    # Купонная ставка
discount_rate = 0.08  # Стоимость денег для держателя облигации
years = 5             # Срок облигации

# Расчет справедливой цены облигации
fair_price = calculate_fair_price(nominal_value, coupon_rate, discount_rate, years)

# Вывод результата
print(f"Справедливая цена облигации: €{fair_price:.2f}")
```

    Справедливая цена облигации: €960.07
    

### Задача 5.
Есть 5-ти летняя облигация, номиналом €1000 и купоном 7%, уплачиваемым 1 раз в год. Текущая цена равна €900. Какова доходность этой облигации?


```python
from scipy.optimize import newton

def ytm_solver(ytm_guess, face_value, coupon_rate, years_to_maturity, current_price):
    """
    Функция для решения YTM методом Ньютона-Рафсона.
    
    :param ytm_guess: Начальное предположение для YTM
    :param face_value: Номинал облигации
    :param coupon_rate: Годовая купонная ставка (в долях единицы)
    :param years_to_maturity: Оставшееся время до погашения облигации в годах
    :param current_price: Текущая цена облигации
    :return: Доходность к погашению (YTM)
    """
    def bond_price(ytm, face_value, coupon_rate, years_to_maturity):
        price = 0
        for t in range(1, years_to_maturity + 1):
            price += coupon_rate * face_value / (1 + ytm) ** t
        price += face_value / (1 + ytm) ** years_to_maturity
        return price
    
    return newton(lambda ytm: bond_price(ytm, face_value, coupon_rate, years_to_maturity) - current_price, ytm_guess)

# Исходные данные
face_value = 1000  # Номинал облигации
coupon_rate = 0.07  # Годовая купонная ставка
years_to_maturity = 5  # Оставшееся время до погашения облигации в годах
current_price = 900  # Текущая цена облигации

# Решение YTM
ytm = ytm_solver(0.05, face_value, coupon_rate, years_to_maturity, current_price)

print("Доходность к погашению (YTM): {:.2%}".format(ytm))
```

    Доходность к погашению (YTM): 9.61%
    

### Задача 5.
Какова справедливая цена 3-летней бескупонной облигации с номиналом €1000, если требуемая доходность для инвестора составляет 12% годовых?


```python
def calculate_fair_price(face_value, required_return, years):
    """
    Рассчитывает справедливую цену бескупонной облигации.
    
    :param face_value: Номинальная стоимость облигации
    :param required_return: Требуемая доходность инвестора
    :param years: Количество лет до погашения
    :return: Справедливая цена облигации
    """
    # Переводим требуемую доходность в десятичную форму
    decimal_required_return = required_return / 100
    
    # Рассчитываем текущую стоимость облигации
    fair_price = face_value / (1 + decimal_required_return)  **  years
    
    return fair_price

# Исходные данные
face_value = 1000  # Номинальная стоимость облигации
required_return = 12  # Требуемая доходность инвестора
years = 3            # Количество лет до погашения

# Расчет справедливой цены облигации
fair_price = calculate_fair_price(face_value, required_return, years)

# Вывод результата
print(f"Справедливая цена облигации: €{fair_price:.2f}")
```

    Справедливая цена облигации: €711.78
    

### Задача 6. 
Есть 5-ти летняя облигация, номиналом €1000 и годовым купоном 7%, уплачиваемым 2 раза в год. Текущая цена равна €900. Какова доходность этой облигации?


```python
from scipy.optimize import fsolve

def bond_price(coupon_rate, face_value, years_to_maturity, yield_rate, coupon_frequency):
    """
    Рассчитывает цену облигации.
    
    :param coupon_rate: Годовая купонная ставка (в долях единицы)
    :param face_value: Номинал облигации
    :param years_to_maturity: Срок до погашения облигации в годах
    :param yield_rate: Доходность к погашению (в долях единицы)
    :param coupon_frequency: Частота выплаты купона в год
    :return: Цена облигации
    """
    total_periods = years_to_maturity * coupon_frequency
    total_coupon_payment = coupon_rate * face_value / coupon_frequency
    total_coupon_value = 0
    for t in range(1, total_periods + 1):
        total_coupon_value += total_coupon_payment / (1 + yield_rate / coupon_frequency) ** t
    face_value_discounted = face_value / (1 + yield_rate / coupon_frequency) ** total_periods
    return total_coupon_value + face_value_discounted

def calculate_yield(coupon_rate, face_value, years_to_maturity, current_price, coupon_frequency):
    """
    Рассчитывает доходность облигации.
    
    :param coupon_rate: Годовая купонная ставка (в долях единицы)
    :param face_value: Номинал облигации
    :param years_to_maturity: Срок до погашения облигации в годах
    :param current_price: Текущая цена облигации
    :param coupon_frequency: Частота выплаты купона в год
    :return: Доходность облигации
    """
    return fsolve(lambda x: bond_price(coupon_rate, face_value, years_to_maturity, x, coupon_frequency) - current_price, 0.05)[0]

# Исходные данные
coupon_rate = 0.07  # Годовая купонная ставка
face_value = 1000  # Номинал облигации
years_to_maturity = 5  # Срок до погашения облигации в годах
current_price = 900  # Текущая цена облигации
coupon_frequency = 2  # Частота выплаты купона в год

# Расчет доходности облигации
yield_rate = calculate_yield(coupon_rate, face_value, years_to_maturity, current_price, coupon_frequency)

print("Доходность облигации: {:.2%}".format(yield_rate))
```

    Доходность облигации: 9.56%
    

### Кредит

Кредит – это финансовая услуга, предоставляемая банками или другими кредитными учреждениями, которая позволяет заемщику получить определенную сумму денег на условиях возвратности, срочности и платности. Это означает, что заемщик обязуется вернуть полученные средства в установленный срок и уплатить проценты за использование этих средств. Кредиты могут быть использованы для различных целей, таких как покупка недвижимости, автомобиля, оплата образования или бизнеса.

### График погашения кредита

График погашения кредита – это документ, который отображает структуру выплат по кредиту во времени. Он показывает, какие суммы должны быть выплачены заемщиком в каждый период времени (обычно ежемесячно), включая основной долг и проценты.

График погашения кредита состоит из двух основных частей:

1. **Основной долг**  – это сумма денег, которую заемщик взял в кредит. В начале графика эта сумма максимальна, но с каждым платежом она уменьшается, так как часть каждого платежа идет на погашение основного долга.

2. **Проценты**  – это плата за использование кредитных средств. Они начисляются на оставшуюся сумму основного долга и добавляются к каждому ежемесячному платежу.

График погашения кредита позволяет заемщику увидеть, сколько он будет платить каждый месяц и как эти выплаты будут распределены между основным долгом и процентами. Это помогает планировать свой бюджет и избегать просрочек платежей.

### Задача 7. 
Банк выдает заемщику кредит в размере 3 млн.руб. на 6 лет под 14% годовых. Сделаем график платежей по кредиту с выделением процентов и основной суммы долга в двух вариантах:
1) если платежи аннуитетные
2) если основной долг гасится равномерными годовыми платежами, начиная со 2-го года


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

def annuity_payment(principal, annual_interest_rate, years):
    """
    Рассчитывает размер аннуитетного платежа.

    :param principal: Основной долг (сумма займа)
    :param annual_interest_rate: Годовая процентная ставка (в долях единицы)
    :param years: Количество лет
    :return: Размер аннуитетного платежа
    """
    r = annual_interest_rate / 12
    n = years * 12
    annuity_factor = (r * (1 + r) ** n) / (((1 + r) ** n) - 1)
    annuity_payment = principal * annuity_factor
    return annuity_payment

def equal_principal_payment(principal, annual_interest_rate, years):
    """
    Рассчитывает размер равномерного годового платежа для погашения основного долга.

    :param principal: Основной долг (сумма займа)
    :param annual_interest_rate: Годовая процентная ставка (в долях единицы)
    :param years: Количество лет
    :return: Размер равномерного годового платежа
    """
    total_payments = years * principal
    total_interest = total_payments * (annual_interest_rate / 2)
    total_payment = total_payments + total_interest
    equal_payment = total_payment / years
    return equal_payment

def create_payment_schedule(principal, annual_interest_rate, years, payment_function):
    """
    Создает график платежей по кредиту.

    :param principal: Основной долг (сумма займа)
    :param annual_interest_rate: Годовая процентная ставка (в долях единицы)
    :param years: Количество лет
    :param payment_function: Функция для расчета платежей
    """
    payments = []
    remaining_balance = principal
    for year in range(1, years + 1):
        payment = payment_function(remaining_balance, annual_interest_rate, years - year + 1)
        interest_payment = remaining_balance * (annual_interest_rate / 12)
        principal_payment = payment - interest_payment
        remaining_balance -= principal_payment
        payments.append((year, payment, interest_payment, principal_payment, remaining_balance))
    
    # Создаем график
    years_range = range(1, years + 1)
    plt.figure(figsize=(12, 6))
    plt.plot(years_range, [payment[1] for payment in payments], label='Общий платеж')
    plt.plot(years_range, [payment[2] for payment in payments], label='Проценты')
    plt.plot(years_range, [payment[3] for payment in payments], label='Основной долг')
    plt.xlabel('Год')
    plt.ylabel('Платеж (руб)')
    plt.title('График платежей по кредиту')
    plt.legend(loc='best')
    plt.grid(True)
    plt.show()

# Исходные данные
principal = 3000000  # Сумма займа в рублях
annual_interest_rate = 0.14  # Годовая процентная ставка
years = 6  # Срок займа в годах

# Создание графика для аннуитетных платежей
print("График платежей для аннуитетных платежей:")
create_payment_schedule(principal, annual_interest_rate, years, annuity_payment)

# Создание графика для равномерных годовых платежей с постепенным погашением основного долга
print("График платежей для равномерных годовых платежей с постепенным погашением основного долга:")
create_payment_schedule(principal, annual_interest_rate, years, equal_principal_payment)
```

    График платежей для аннуитетных платежей:
    


    
![png](output_57_1.png)
    


    График платежей для равномерных годовых платежей с постепенным погашением основного долга:
    


    
![png](output_57_3.png)
    


### Лизинг

**Лизинг** – это финансовый инструмент, при котором одна сторона (лизингодатель) предоставляет другой стороне (лизингополучателю) право использовать определенное имущество (объект лизинга) в обмен на периодические платежи.

Лизинг часто используется для приобретения дорогостоящего оборудования или транспортных средств, когда компания не может позволить себе купить их сразу. Вместо этого, они могут арендовать необходимое оборудование или транспорт на определенный срок и выплачивать его стоимость постепенно.

Существуют различные виды лизинга, такие как операционный лизинг, финансовый лизинг и возвратный лизинг. Каждый вид имеет свои особенности и применяется в зависимости от потребностей компании.

1. **Операционный лизинг**: Это форма лизинга, при которой лизингодатель (компания, предоставляющая лизинг) предоставляет лизингополучателю (клиенту) право использования имущества на определенный период времени, но не передает ему право на покупку этого имущества по истечении срока лизинга. Операционный лизинг обычно используется для приобретения оборудования или техники на короткий срок, и часто включает в себя дополнительные услуги, такие как обслуживание и техническая поддержка.

2. **Финансовый лизинг**: Это форма лизинга, при которой лизингодатель (финансовая компания) предоставляет лизингополучателю (клиенту) право использования имущества на определенный период времени, а по истечении этого срока клиент имеет опцию выкупа этого имущества по заранее оговоренной цене. Финансовый лизинг часто используется для длительного оборудования и транспортных средств, и обычно предполагает существенные финансовые обязательства со стороны лизингополучателя.

### Задача 8. 
Лизинговая компания заключает договор финансового лизинга на имущество стоимостью 3000000 руб. на 6 лет под 14% годовых. Выкупная стоимость имущества в конце срока лизинга составляет 1000000 руб. Сделать график платежей по лизингу с выделением процентов и основной суммы долга, если график платежей аннуитетный.


```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

def annuity_payment(principal, annual_interest_rate, years):
    """
    Рассчитывает размер аннуитетного платежа.

    :param principal: Основной долг (сумма займа)
    :param annual_interest_rate: Годовая процентная ставка (в долях единицы)
    :param years: Количество лет
    :return: Размер аннуитетного платежа
    """
    r = annual_interest_rate / 12
    n = years * 12
    annuity_factor = (r * (1 + r) ** n) / (((1 + r) ** n) - 1)
    annuity_payment = principal * annuity_factor
    return annuity_payment

def create_leasing_schedule(principal, annual_interest_rate, years, residual_value):
    """
    Создает график платежей по лизингу.

    :param principal: Основной долг (сумма займа)
    :param annual_interest_rate: Годовая процентная ставка (в долях единицы)
    :param years: Количество лет
    :param residual_value: Выкупная стоимость имущества в конце срока лизинга
    """
    payments = []
    remaining_balance = principal
    annuity_pmt = annuity_payment(principal - residual_value, annual_interest_rate, years)
    for month in range(1, years * 12 + 1):
        interest_payment = remaining_balance * (annual_interest_rate / 12)
        principal_payment = annuity_pmt - interest_payment
        remaining_balance -= principal_payment
        if remaining_balance < 0:
            remaining_balance = 0
        payments.append((month, annuity_pmt, interest_payment, principal_payment, remaining_balance))

    # Создаем DataFrame для хранения данных о платежах
    df = pd.DataFrame(payments, columns=['Месяц', 'Аннуитетный платеж', 'Проценты', 'Основной долг', 'Остаток долга'])

    # Создаем график
    plt.figure(figsize=(12, 6))
    plt.plot(df['Месяц'], df['Проценты'], label='Проценты')
    plt.plot(df['Месяц'], df['Основной долг'], label='Основной долг')
    plt.xlabel('Месяц')
    plt.ylabel('Сумма (руб)')
    plt.title('График платежей по лизингу')
    plt.legend()
    plt.grid(True)
    plt.show()

# Исходные данные
principal = 3000000  # Сумма займа в рублях
annual_interest_rate = 0.14  # Годовая процентная ставка
years = 6  # Срок займа в годах
residual_value = 1000000  # Выкупная стоимость имущества в конце срока лизинга

# Создание графика платежей по лизингу
create_leasing_schedule(principal, annual_interest_rate, years, residual_value)
```


    
![png](output_61_0.png)
    


### Используемые и рекомендуемые источники:
- Четыркин Е.М. Финансовая математика
- А. Лобанов. Энциклопедия финансового риск-менеджмента
